<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="msvalidate.01" content="5B57D04D465AB9C871A8DD4414956DB4" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Excel sheets using F# without COM &middot; Coding Journal</title>

    <meta name="description" content="">

    <meta name="generator" content="Hugo 0.15" />
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="Reading Excel sheets using F# without COM &middot; Coding Journal">
    <meta name="twitter:description" content="">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Reading Excel sheets using F# without COM &middot; Coding Journal">
    <meta property="og:description" content="">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
    <!--<![endif]-->

    <link rel="stylesheet" href="https://blog.kulman.sk/css/all.min.css">    
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://blog.kulman.sk/css/custom.css">

    <link rel="alternate" type="application/rss+xml" title="Coding Journal" href="https://blog.kulman.sk/index.xml" />
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="https://blog.kulman.sk">Coding Journal</a></h1>
            <h2 class="brand-tagline"> Adventures in the world of C#, F# and WinRT </h2>
        </hgroup>

        <nav class="nav wide-only">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a class="pure-button" href="https://twitter.com/igorkulman"><i class="fa fa-twitter"></i> Twitter</a>
                </li>
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/igorkulman "><i class="fa fa-github-alt"></i> github</a>
                </li>
                
                <li class="nav-item">
                    <a class="pure-button" href="https://blog.kulman.sk/index.xml"><i class="fa fa-rss"></i> rss</a>
                </li>
            </ul>
        </nav>


<ul class="menu">
   <li class="menu-item"><a href="/">Blog</a></li>
    <li class="menu-item"><a href="/projects">Projects</a></li>
    <li class="menu-item"><a href="/about">About</a></li>
</ul>


    </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                <h1 class="content-subhead">06 Feb 2013</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://blog.kulman.sk/reading-excel-sheets-using-f-without-com/" class="post-title">Reading Excel sheets using F# without COM</a>

                        <p class="post-meta">
                            
                                By <strong class="post-author">Igor Kulman</strong>
                            
                            
                                under 
                                
                                <a class="post-category post-category-Functional programming" href="https://blog.kulman.sk/categories/functional-programming">Functional programming</a>
                            
                        </p>
                    </header>

                  
                    <div class="post-description">
                        <p>I needed to create an utility that would read Excel 2010 files (.xlsx) and generate XML files from them according to some specific rules. The catch was that the utility needed to run on MacOS instead of Windows.</p>

<p>Reading and writing Excel files from .NET is <a href="http://blogs.msdn.com/b/jackhu/archive/2011/04/19/fsharp-amp-excel-io-reading-and-writeing-to-excel.aspx">very easy using the Microsoft.Office.Interop assemblies</a> but they use Excel through COM and that makes them unusable outside of Windows. I found some 3rd party libraries for working with Excel and analzyed them with <a href="http://www.mono-project.com/MoMA">The Mono Migration Analzyer</a> (MoMA). MoMA is a handy tool that analyzes .NET assemblies and tells you if they will run on Mono. Many of the Excel libraries I found were unusable for my use-case because they were using PInvoke calls. Only the <a href="http://excelpackage.codeplex.com/">ExcelPackage library</a> runs on Mono.</p>

<p>I wanted to use the ExcelPackage from F# not C# so I wrote a <a href="https://github.com/igorkulman/ExcelPackageF">very simple F# wrapper</a>, that you can freely use. For now it contains just a few methods</p>

<p>Excel.getWorksheets</p>

<p>Excel.getWorksheetByIndex</p>

<p>Excel.getWorksheetByName</p>

<p>Excel.getMaxRowNumber</p>

<p>Excel.getMaxColNumber</p>

<p>Excel.getContent</p>

<p>Excel.getColumn</p>

<p>Excel.getRow</p>

<p>but I will be adding a few more soon. The usage is really simple. For example, if you want to read the whole sheet number 1 from a file called text.xlsx, use</p>

<script src="https://gist.github.com/5822019.js"></script>

<p><strong>EDIT</strong>: Now available as a Nuget package:</p>

<pre><code class="language-fsharp">PM&gt; Install-Package ExcelPackageF
</code></pre>

                    </div>


                    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'coudingjournal';
    var disqus_identifier = 'https:\/\/blog.kulman.sk\/reading-excel-sheets-using-f-without-com\/';
    var disqus_title = 'Reading Excel sheets using F# without COM';
    var disqus_url = 'https:\/\/blog.kulman.sk\/reading-excel-sheets-using-f-without-com\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

                    
                </section>
            </div>
            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="http://hugo.spf13.com/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src="https://blog.kulman.sk/js/all.min.js"></script>
        </div>
    </div>
</div>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-49528577-2', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
